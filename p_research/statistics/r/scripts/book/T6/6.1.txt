

setwd("C:/DATOS/DOCUMENTACION/DOCTORADO/MODELOS/R/REGRESION")
source('simpleRegressionFunctions.txt', local=TRUE)

'EJERCICIO 5.1

'EXPLICACION DE DATOS
'costes.dat  
'Fuente: datos confidenciales. 35 datos de coste total y unidades fabricadas en plantas de producción y el montaje de placas de ordenadores  
'Descripción: 
'Primera columna: costes totales de fabricación
'Segunda columna : número de unidades fabricadas 

'A: CARGA DE DATOS

DATOS <- read.table("C:/DATOS/DOCUMENTACION/DOCTORADO/MODELOS/R/REGRESION/DATOS_LIBRO/costes.dat",header=F,sep="", quote="") 

Y = as.numeric(DATOS$V1)
X = as.numeric(DATOS$V2)

TY <- "Costes Totales\n de Fabricación, CTF"
TX <- "Unidades Fabricadas, UF"

'B: UNIVARIATE EDA

viewEDA(Y,X,TY,TX)

'CONCLUSIONES:
'Nos centramos en el diagnostico. ver ejercicio E_5.1.txt

'C: CREATE MODEL

REGRESSION <- createSRM(Y,X,1)
REGRESSION

'CONCLUSIONES
'Los resultados de la regresión son:

'Residuals:
'      Min        1Q    Median        3Q       Max 
'-137.3857  -24.4961   -0.1167   29.8479  105.0283 

'Coefficients:
'            Estimate Std. Error t value Pr(>|t|)    
'(Intercept) 33.92200   11.57500   2.931   0.0061 ** 
'X            0.09640    0.01665   5.789 1.80e-06 ***
'---
'Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

'Residual standard error: 44.49 on 33 degrees of freedom
'Multiple R-Squared: 0.5039,	Adjusted R-squared: 0.4888 
'F-statistic: 33.51 on 1 and 33 DF,  p-value: 1.796e-06

'Si se analizamos el grafico Normal Q-Q en el cual se muestran los residuos, frente
'a las predicciones, observamos como existen indicios de falta de linealidad.


'Si analizamos los graficos observamos una serie de puntos palanca.






' NOTA: Si se detectan datos outliers, es necesario eliminarlos del modelo

SET1 <- simpleOutlierDetection(Y,1)
SET2 <- simpleOutlierDetection(X,1)

SET1
SET2


SELECTION <- getCriterioSelection (SET1,SET2,1)
SELECTION

DATOS2 <- getDataSelection(Y,X,SELECTION,1)

Y2 <- DATOS2[1,]
Y2

X2 <- DATOS2[2,]
X2

'NOTA: Una vez tengo detectado donde estan los datos OUTLIERS que afectan al modelo, se vuelve a generar el modelo.

'Y2 = getSubconjunto(Y,1,31)
'X2 = getSubconjunto(X,1,31)

viewEDA(Y2,X2,TY,TX)

'CONCLUSIONES

REGRESSION2 <- createSRM(Y2,X2,1)
REGRESSION2

'CONCLUSIONES
'Los resultados de la regresión son:

SET1 <- simpleOutlierDetection(Y2,1)
SET2 <- simpleOutlierDetection(X2,1)

SET1
SET2
