###################################
# SCRIPT DE ANALISIS DE DATOS     #
# Autor: Juan Antonio Breña Moral #
# Email: bren@juanantonio.info    #
###################################
# NOTA: Este Script se ha desarrollado para el analisis de ventas de CEGELEC
# en ejercicio economico 2004/2005
# Permite realizar analisis de normalidad de datos

JAB.EDA.NORMAL_TEST <-function(DATOS,CONFIANZA){
	EVALUACION <- 1-CONFIANZA
	
	if(length(DATOS)>= 250){
		DATOS_NORMAL <- rnorm(1000)
		KS <-ks.test(DATOS,DATOS_NORMAL)
		P_VALUE <- KS$p.value
		print(KS)

	}else{
		SW <- shapiro.test(DATOS)
		P_VALUE <- SW$p.value
		print(SW)
	}
	
	if (P_VALUE < EVALUACION){
		print("Los datos siguen una distribución normal.")
		BANDERA = TRUE
	}else{
		print("Los datos no siguen una distribución normal.")	
		BANDERA = FALSE
	}
	return(BANDERA)
}

JAB.EDA.NORMAL_TEST(CLL_R,0.95)
